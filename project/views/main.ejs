<!DOCTYPE html>
    <head>
        <meta charset="UTF-8">
        <title>Main</title>

        <link rel="stylesheet" type="text/css" href="footer.css">
        <link rel="stylesheet" type="text/css" href="header.css">
        <link rel="stylesheet" type="text/css" href="main.css">
        <link rel="stylesheet" type="text/css" href="var.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet">
    </head>
    <body>
        <p class="hidden-param" id="tags_json"></p>
        <p class="hidden-param" id="idCard"></p>

        <% include ../models/header %>

        <form method="get" action="/index">
            <div id="divSearch">
                <input type="text" name="search" placeholder="Search" pattern="([A-Za-z1-9àéèüöä+ç%&()=?^.,;:_]{1,40})" title="[espace], -, #, ', |, *, '' inderdits">
                <button type="submit"><i class="fas fa-search fa-2x"></i></button>
            </div>
        </form>
        <div id="order-content">
            <% if (order == "normal") { %>
                <button onclick="window.location.assign('/?order=normal')" id="active-order">normal</button>
                <button onclick="window.location.assign('/?order=asc')" id="inactive-order">asc</button>
                <button onclick="window.location.assign('/?order=desc')" id="inactive-order">desc</button>
            <% } else if (order == "asc") { %>
                <button onclick="window.location.assign('/?order=normal')" id="inactive-order">normal</button>
                <button onclick="window.location.assign('/?order=asc')" id="active-order">asc</button>
                <button onclick="window.location.assign('/?order=desc')" id="inactive-order">desc</button>
            <% } else { %>
                <button onclick="window.location.assign('/?order=normal')" id="inactive-order">normal</button>
                <button onclick="window.location.assign('/?order=asc')" id="inactive-order">asc</button>
                <button onclick="window.location.assign('/?order=desc')" id="active-order">desc</button>
            <% } %>
        </div>

        <!-- Content -->
        <table id="table-header-second">
            <td><td><a class="display-add-card" id="displayAddCard">Ajouter</a></td><td><a href="http://localhost:8081/register">S'enregistrer</a></td></td>
        </table>

        <div class="add-card-content-hidden">
            <div id="form">
                <button class="button-close" id="icon"><i class="far fa-times-circle fa-2x"></i></button>

                <% include ../models/form.add.ejs %>
            </div>
        </div>

        <% if (goToAcceuil) { %>
            <p id="link-accueil">Retour à <a href="index">l'acceuil</a></p>
        <% } %>

        <div id="main-content">
            <% var count = 0 %>
            <% cards.dataset.forEach((card) => { %>
                <% count++ %>
                <% if(count == cards.dataset.length) { %>
                    <div class="card-main-left" id="last-card">
                <% } else { %>
                    <div class="card-main-left">
                <% } %>
                    <div class="tag-content">
                        <% card.tags.forEach((tag) => { %>
                            <h5 style="background-color: #<%= tag.tagColor %>"><%= tag.tagName %></h5>
                        <% }) %>
                    </div>
                    <h2 class="card-title"><%= card.carTitle %></h2>
                    <p class="card-desc"><%= card.carDesc %></p>
                    <p class="card-content"><%= card.carContent %></p>
                    <p class="card-metrique">priorité <%= card.carMetrique %>/255</p>
                    <p class="card-link"><a href="/modify?id=<%= card.idCard %>">Modifier</a> <a href="/delete?id=<%= card.idCard %>">Supprimer</a></p>
                </div>
            <% }) %>
        </div>
            

        <% include ../models/footer %>

        <script type="text/javascript" src="tag.js"></script>
        <script type="text/javascript" src="jquery(3-4-1).min.js"></script>
        <script type="text/javascript" src="event.js"></script>
    </body>
</html>